jQuery.fn.timelinr=function(a){settings=jQuery.extend({orientation:"horizontal",containerDiv:"#timeline-1",datesDiv:a.containerDiv+" .dates",datesSelectedClass:"selected",datesSpeed:"normal",issuesDiv:a.containerDiv+" .issues",issuesSelectedClass:"selected",issuesSpeed:"normal",issuesTransparency:0.2,issuesTransparencySpeed:500,prevButton:a.containerDiv+" .prev",nextButton:a.containerDiv+" .next",arrowKeys:"true",startAt:1,autoPlay:"false",autoPlayDirection:"forward",autoPlayPause:3000,fixedSize:"true",},a);jQuery(function(){var f=jQuery(a.containerDiv);var w="";var n=jQuery(f).find("ul.issues");w+="<ul class='dates'>";jQuery(n).find("li").each(function(y){if(jQuery(this).attr("name").match("^__")){w+="<li><a href='#"+jQuery(this).attr("name")+'\'><span class="sr-only">'+jQuery(this).attr("name")+"</span>&nbsp;&nbsp;&nbsp;&nbsp;</a></li>"}else{w+="<li><a href='#"+jQuery(this).attr("name")+"'>"+jQuery(this).attr("name")+"</a></li>"}});w+="</ul>";jQuery(f).prepend(w);if(jQuery(settings.datesDiv).length>0&&jQuery(settings.issuesDiv).length>0){if(a.fixedSize=="true"){updateSize()}var o=jQuery(settings.datesDiv+" li").length;var c=jQuery(settings.issuesDiv+" li").length;var k=jQuery(settings.datesDiv).find("a."+settings.datesSelectedClass);var v=jQuery(settings.issuesDiv).find("li."+settings.issuesSelectedClass);var u=jQuery(settings.containerDiv).width();var p=jQuery(settings.containerDiv).height();var m=jQuery(settings.issuesDiv).width();var s=jQuery(settings.issuesDiv).height();var h=jQuery(settings.issuesDiv+" li").width();var g=jQuery(settings.issuesDiv+" li").height();var j=jQuery(settings.datesDiv).width();var i=jQuery(settings.datesDiv).height();var r=jQuery(settings.datesDiv+" li").width();var t=jQuery(settings.datesDiv+" li").height();var b=jQuery(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();var q=jQuery(settings.datesDiv+" li").eq(b).find("a").attr("href");var e=jQuery(settings.datesDiv+" li").eq(b+2).find("a").attr("href");if(settings.orientation=="horizontal"){jQuery(settings.issuesDiv).find("li").width(u);jQuery(settings.issuesDiv).width(h*c);jQuery(settings.datesDiv).width(r*o).css("marginLeft",u/2-r/2);var l=parseInt(jQuery(settings.datesDiv).css("marginLeft").substring(0,jQuery(settings.datesDiv).css("marginLeft").indexOf("px")))}else{if(settings.orientation=="vertical"){g=+g+ +100;jQuery(settings.issuesDiv).find("li").width(u-j);jQuery(settings.issuesDiv).height(g*c);jQuery(settings.datesDiv).height(t*o).css("marginTop",t);var l=parseInt(jQuery(settings.datesDiv).css("marginTop").substring(0,jQuery(settings.datesDiv).css("marginTop").indexOf("px")))}}var q=jQuery(settings.datesDiv+" li").eq(settings.startAt-2).find("a").attr("href");var e=jQuery(settings.datesDiv+" li").eq(settings.startAt).find("a").attr("href");jQuery(settings.prevButton).attr("href",q);jQuery(settings.nextButton).attr("href",e);jQuery(settings.datesDiv+" a").click(function(z){var B=jQuery(this).text();var y=jQuery(this).parent().prevAll().length;if(settings.orientation=="horizontal"){jQuery(settings.issuesDiv).animate({marginLeft:-h*y},{queue:false,duration:settings.issuesSpeed})}else{if(settings.orientation=="vertical"){jQuery(settings.issuesDiv).animate({marginTop:-g*y},{queue:false,duration:settings.issuesSpeed})}}jQuery(settings.issuesDiv+" li").animate({opacity:settings.issuesTransparency},{queue:false,duration:settings.issuesSpeed}).removeClass(settings.issuesSelectedClass).eq(y).addClass(settings.issuesSelectedClass).fadeTo(settings.issuesTransparencySpeed,1);if(o==1){jQuery(settings.prevButton+","+settings.nextButton).fadeOut("fast")}else{if(o==2){if(jQuery(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.prevButton).fadeOut("fast");jQuery(settings.nextButton).fadeIn("fast")}else{if(jQuery(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.nextButton).fadeOut("fast");jQuery(settings.prevButton).fadeIn("fast")}}}else{if(jQuery(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.nextButton).fadeIn("fast");jQuery(settings.prevButton).fadeOut("fast")}else{if(jQuery(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.prevButton).fadeIn("fast");jQuery(settings.nextButton).fadeOut("fast")}else{jQuery(settings.nextButton+","+settings.prevButton).fadeIn("slow")}}}}jQuery(settings.datesDiv+" a").removeClass(settings.datesSelectedClass);jQuery(this).addClass(settings.datesSelectedClass);if(settings.orientation=="horizontal"){jQuery(settings.datesDiv).animate({marginLeft:l-(r*y)},{queue:false,duration:"settings.datesSpeed"})}else{if(settings.orientation=="vertical"){jQuery(settings.datesDiv).animate({marginTop:l-(t*y)},{queue:false,duration:"settings.datesSpeed"})}}var C=jQuery(settings.datesDiv+" li").eq(y-1).find("a").attr("href");var A=jQuery(settings.datesDiv+" li").eq(y+1).find("a").attr("href");jQuery(settings.prevButton).attr("href",C);jQuery(settings.nextButton).attr("href",A)});jQuery(settings.nextButton).bind("click",function(z){var y=jQuery(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();var D=jQuery(settings.datesDiv+" li").eq(y).find("a").attr("href");var B=jQuery(settings.datesDiv+" li").eq(y+2).find("a").attr("href");if(settings.orientation=="horizontal"){var F=parseInt(jQuery(settings.issuesDiv).css("marginLeft").substring(0,jQuery(settings.issuesDiv).css("marginLeft").indexOf("px")));var E=F/h;var A=parseInt(jQuery(settings.datesDiv).css("marginLeft").substring(0,jQuery(settings.datesDiv).css("marginLeft").indexOf("px")));var C=A-r;if(F<=-(h*c-(h))){jQuery(settings.issuesDiv).stop();jQuery(settings.datesDiv+" li:last-child a").click()}else{if(!jQuery(settings.issuesDiv).is(":animated")){jQuery(settings.datesDiv+" li").eq(y+1).find("a").trigger("click");console.log(y,D,B);jQuery(settings.prevButton).attr("href",D);jQuery(settings.nextButton).attr("href",B)}}}else{if(settings.orientation=="vertical"){var F=parseInt(jQuery(settings.issuesDiv).css("marginTop").substring(0,jQuery(settings.issuesDiv).css("marginTop").indexOf("px")));var E=F/g;var A=parseInt(jQuery(settings.datesDiv).css("marginTop").substring(0,jQuery(settings.datesDiv).css("marginTop").indexOf("px")));var C=A-t;if(F<=-(g*c-(g))){jQuery(settings.issuesDiv).stop();jQuery(settings.datesDiv+" li:last-child a").click()}else{if(!jQuery(settings.issuesDiv).is(":animated")){jQuery(settings.prevButton).attr("href",D);jQuery(settings.nextButton).attr("href",B);jQuery(settings.datesDiv+" li").eq(y+1).find("a").trigger("click")}}}}if(o==1){jQuery(settings.prevButton+","+settings.nextButton).fadeOut("fast")}else{if(o==2){if(jQuery(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.prevButton).fadeOut("fast");jQuery(settings.nextButton).fadeIn("fast")}else{if(jQuery(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.nextButton).fadeOut("fast");jQuery(settings.prevButton).fadeIn("fast")}}}else{if(jQuery(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.prevButton).fadeOut("fast")}else{if(jQuery(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.nextButton).fadeOut("fast")}else{jQuery(settings.nextButton+","+settings.prevButton).fadeIn("slow")}}}}});jQuery(settings.prevButton).click(function(z){var y=jQuery(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();var D=jQuery(settings.datesDiv+" li").eq(y).find("a").attr("href");var B=jQuery(settings.datesDiv+" li").eq(y+2).find("a").attr("href");if(settings.orientation=="horizontal"){var F=parseInt(jQuery(settings.issuesDiv).css("marginLeft").substring(0,jQuery(settings.issuesDiv).css("marginLeft").indexOf("px")));var E=F/h;var A=parseInt(jQuery(settings.datesDiv).css("marginLeft").substring(0,jQuery(settings.datesDiv).css("marginLeft").indexOf("px")));var C=A+r;if(F>=0){jQuery(settings.issuesDiv).stop();jQuery(settings.datesDiv+" li:first-child a").click()}else{if(!jQuery(settings.issuesDiv).is(":animated")){jQuery(settings.datesDiv+" li").eq(y-1).find("a").trigger("click");console.log(y,D,B);jQuery(settings.prevButton).attr("href",D);jQuery(settings.nextButton).attr("href",B)}}}else{if(settings.orientation=="vertical"){var F=parseInt(jQuery(settings.issuesDiv).css("marginTop").substring(0,jQuery(settings.issuesDiv).css("marginTop").indexOf("px")));var E=F/g;var A=parseInt(jQuery(settings.datesDiv).css("marginTop").substring(0,jQuery(settings.datesDiv).css("marginTop").indexOf("px")));var C=A+t;if(F>=0){jQuery(settings.issuesDiv).stop();jQuery(settings.datesDiv+" li:first-child a").click()}else{if(!jQuery(settings.issuesDiv).is(":animated")){jQuery(settings.prevButton).attr("href",D);jQuery(settings.nextButton).attr("href",B);jQuery(settings.datesDiv+" li").eq(y-1).find("a").trigger("click")}}}}if(o==1){jQuery(settings.prevButton+","+settings.nextButton).fadeOut("fast")}else{if(o==2){if(jQuery(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.prevButton).fadeOut("fast");jQuery(settings.nextButton).fadeIn("fast")}else{if(jQuery(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.nextButton).fadeOut("fast");jQuery(settings.prevButton).fadeIn("fast")}}}else{if(jQuery(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.prevButton).fadeOut("fast")}else{if(jQuery(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){jQuery(settings.nextButton).fadeOut("fast")}else{jQuery(settings.nextButton+","+settings.prevButton).fadeIn("slow")}}}}});if(settings.arrowKeys=="true"){if(settings.orientation=="horizontal"){jQuery(document).keydown(function(y){if(y.keyCode==39){jQuery(settings.nextButton).click()}if(y.keyCode==37){jQuery(settings.prevButton).click()}})}else{if(settings.orientation=="vertical"){jQuery(document).keydown(function(y){if(y.keyCode==40){jQuery(settings.nextButton).click()}if(y.keyCode==38){jQuery(settings.prevButton).click()}})}}}if(window.location.hash){var d=window.location.hash.slice(1);jQuery(settings.datesDiv+" li").find("a[href=#"+d+"]").trigger("click")}else{jQuery(settings.datesDiv+" li").eq(settings.startAt-1).find("a").trigger("click")}var x=null;if(settings.autoPlay=="true"){var x=setInterval("autoPlay()",settings.autoPlayPause)}jQuery("a.toggle-autoplay").click(function(){var z='<i class="fa fa-play" aria-hidden="true"></i><span class="sr-only">Play</span>';var y='<i class="fa fa-pause" aria-hidden="true"></i><span class="sr-only">Pause</span>';if(jQuery(this).data("toggle")==="pause"){clearInterval(x);jQuery("a.toggle-autoplay").html(z).data("toggle","play")}else{if(jQuery(this).data("toggle")==="play"){x=setInterval("autoPlay()",settings.autoPlayPause);jQuery("a.toggle-autoplay").html(y).data("toggle","pause")}}})}})};function autoPlay(){var a=jQuery(settings.datesDiv).find("a."+settings.datesSelectedClass);if(settings.autoPlayDirection=="forward"){if(a.parent().is("li:last-child")){jQuery(settings.datesDiv+" li:first-child").find("a").trigger("click")}else{a.parent().next().find("a").trigger("click")}}else{if(settings.autoPlayDirection=="backward"){if(a.parent().is("li:first-child")){jQuery(settings.datesDiv+" li:last-child").find("a").trigger("click")}else{a.parent().prev().find("a").trigger("click")}}}}function updateSize(){var a=parseInt(jQuery(".issues li").eq(0).css("height"));jQuery(settings.issuesDiv+" li").each(function(){if(settings.orientation=="vertical"){jQuery(settings.issuesDiv+" li").css("width",(jQuery(settings.containerDiv).width()-jQuery(settings.datesDiv).width()))}var b=parseInt(jQuery(this).css("height"));a=(a>=b?a:b)});jQuery(settings.issuesDiv+" li").css("height",(+a+ +50)+"px");if(settings.orientation=="vertical"){jQuery(settings.containerDiv).css("height",(+a+ +50)+"px")}else{jQuery(settings.containerDiv).css("height",(+a+ +100+jQuery(settings.datesDiv).height())+"px")}};